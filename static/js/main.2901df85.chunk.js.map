{"version":3,"sources":["Radio.js","Logo.js","App.js","index.js"],"names":["videoList","radioCycle","unshuffledRadioQueue","radioQueue","radioPosition","totalDuration","i","length","push","duration","randNumber","seed","random","Math","sin","floor","Radio","useState","volume","setVolume","changeVolume","_","value","cycle","videoID","songName","currentVideo","setCurrentVideo","updateSong","time","Date","now","array","j","shuffleArray","video","shift","syncRadio","newCurrentVideo","name","setVideoID","undefined","useEffect","videoObject","document","getElementById","load","currentTime","id","autoPlay","onEnded","src","type","Grid","container","item","xs","md","alignItems","gradient","Typography","VolumeDown","onClick","Slider","onChange","VolumeUp","Logo","variant","theme","createMuiTheme","typography","fontFamily","App","ThemeProvider","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.2901df85.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport {Typography, Slider, Grid} from '@material-ui/core'\r\nimport {VolumeDown, VolumeUp} from '@material-ui/icons'\r\nimport Marquee from \"react-fast-marquee\";\r\n\r\nconst videoList = [\r\n    {'src':'/videos/Just-Communication.mp4', 'duration':260, 'name':'Mobile Suit Gundam Wing - Just Communication   '},\r\n    {'src':'/videos/Fly-Gundam.mp4', 'duration':89, 'name':'Mobile Suit Gundam - Fly! Gundam!   '},\r\n    {'src':'/videos/Bubblegum-Crisis-Konya-Wa-Hurricane.mp4', 'duration':291, 'name':'Bubblegum Crisis - Konya Wa Hurricane   '},\r\n    {'src':'/videos/MD-Geist-Violence-of-the-Flame.mp4', 'duration':240, 'name':'M.D. Geist - Violence of the Flame   '},\r\n    {'src':'/videos/Yellow-Dancer-(Lancer)-Look-Up-the-Sky-is-Falling.mp4', 'duration':285, 'name':'Yellow Dancer (Lancer) - Look Up the Sky is Falling   '},\r\n    {'src':'/videos/Choujuu-Kishin-Dancouga-Ai-yo-Far-Away.mp4', 'duration':246, 'name':'Choujuu Kishin - Dancouga Ai yo Far Away   '},\r\n    {'src':'/videos/Mobile-Police-Patlabor-(Early-Days)-Opening-Remastered.mp4', 'duration':90, 'name':'Mobile Police Patlabor (Early Days) - Opening (Remastered)   '},\r\n    {'src':'/videos/Trider-G7-Opening.mp4', 'duration':86, 'name':'Trider G7 - Opening   '},\r\n    {'src':'/videos/Aku-Daisakusen-Slangle-Late-FIGHTING-ON.mp4', 'duration':80, 'name':'Aku Daisakusen Slangle Late - FIGHTING ON   '},\r\n    {'src':'/videos/Aura-Battler-Dunbine-OP.mp4', 'duration':91, 'name':'Aura Battler Dunbine - Opening   '},\r\n    {'src':'/videos/Metal-Armor-Dragonar-Opening-1.mp4', 'duration':90, 'name':'Metal Armor Dragonar - Opening 1   '},\r\n]\r\n\r\nvar radioCycle = 1\r\nvar unshuffledRadioQueue = []\r\nvar radioQueue = []\r\nvar radioPosition = 0\r\nvar totalDuration = 0\r\n\r\nfor (let i = 0; i < videoList.length; i++) {\r\n    //set up some variables\r\n    unshuffledRadioQueue.push(i)\r\n    totalDuration += videoList[i].duration\r\n}\r\n\r\n//generates a pseudorandom value between 0 and 1\r\nfunction randNumber(seed) {\r\n    var random = Math.sin(seed)*43758.5453123\r\n\treturn random - Math.floor(random)\r\n}\r\n\r\n//pseudorandomly shuffles an array\r\nfunction shuffleArray(array, seed) {\r\n    for (let i = array.length - 1; i > 0; i--) {\r\n        const j = Math.floor(randNumber(seed * i) * (i + 1));\r\n        [array[i], array[j]] = [array[j], array[i]];\r\n    }\r\n}\r\n\r\n\r\nexport default function Radio() {\r\n    //stores the volume\r\n    const [volume, setVolume] = useState(0)\r\n    \r\n    function changeVolume(_, value) {\r\n        setVolume(value)\r\n    }\r\n\r\n    //stores info about the video being played\r\n    const [currentVideo, setCurrentVideo] = useState({\r\n        cycle: 0,\r\n        videoID: 0,\r\n        songName: ''\r\n    })\r\n\r\n    function setVideoID(value) {\r\n        let newCurrentVideo = {\r\n            cycle: radioCycle,\r\n            videoID: value,\r\n            songName: videoList[value].name\r\n        }\r\n        setCurrentVideo(newCurrentVideo)\r\n    }\r\n\r\n    //changes the current song to the one that should be playing\r\n    function updateSong() {\r\n        syncRadio()\r\n        setVideoID(radioQueue[0])\r\n        changeVolume(undefined, volume)\r\n    }\r\n\r\n    function syncRadio() {\r\n        //use unix time to sync all clients to the same song and position\r\n        let time = Math.floor(Date.now() / 1000)\r\n\r\n        //after all the songs have played, radioCycle increases\r\n        //when this happens, reshuffle the radioQueue based on the new value\r\n        //this causes the songs to play in a different order each time\r\n        radioCycle = Math.floor(time / totalDuration)\r\n        radioQueue = [...unshuffledRadioQueue]\r\n        shuffleArray(radioQueue, radioCycle)\r\n\r\n        //radioPosition is how far along in the radioQueue we should be (in seconds)\r\n        //iterate through each video in the queue until we reach the correct one\r\n        radioPosition = time % totalDuration\r\n        for (let i = 0; i < radioQueue.length; i++) {\r\n            let video = videoList[radioQueue[0]]\r\n            if (radioPosition < video.duration) { break }\r\n\r\n            radioPosition -= video.duration\r\n            radioQueue.push(radioQueue.shift())\r\n            if (radioPosition < 1) { radioPosition = 1 } //safeguard for when radioPosition is close to 0\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        //when a new song is loaded, set its time to the radioPosition\r\n        let videoObject = document.getElementById('background-video')\r\n        videoObject.load()\r\n        videoObject.currentTime = radioPosition\r\n    }, [currentVideo])\r\n\r\n    useEffect(() => {\r\n        //when a new song is loaded, or when the volume is changed, set the volume\r\n        let videoObject = document.getElementById('background-video')\r\n        videoObject.volume = volume/100.0\r\n    }, [volume, currentVideo])\r\n    \r\n    //start the radio on page load\r\n    useEffect(() => {\r\n        updateSong()\r\n        changeVolume(undefined, 0) //start muted\r\n    }, [])\r\n\r\n    return (\r\n        <div>\r\n            <video id='background-video' autoPlay key={currentVideo.videoID} onEnded={() => {updateSong()}}>\r\n                <source src={videoList[currentVideo.videoID].src} type='video/mp4' />\r\n                Your browser does not support this video format.\r\n            </video>\r\n\r\n            <div id=\"radio-controls\">\r\n                <Grid container item xs={4} md={2} alignItems=\"center\">  \r\n                    <Marquee gradient={false}>\r\n                        <Typography>\r\n                            Now Playing: {currentVideo.songName}\r\n                        </Typography>\r\n                    </Marquee>\r\n                </Grid>\r\n                <Grid container item xs={4} md={2} alignItems=\"center\">\r\n                    <Grid item xs={1}>\r\n                        <VolumeDown onClick={() => {changeVolume(undefined, 0)}} />\r\n                    </Grid>\r\n                    <Grid item xs={10}>\r\n                        <Slider value={volume} onChange={changeVolume} />\r\n                    </Grid>\r\n                    <Grid item xs={1}>\r\n                        <VolumeUp onClick={() => {changeVolume(undefined, 100)}} />\r\n                    </Grid>\r\n                </Grid>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport { Typography } from '@material-ui/core'\r\n\r\nexport default function Logo() {\r\n    return (\r\n        <div id=\"logo\">\r\n            <Typography variant=\"h4\">\r\n                Tokemak.radio\r\n            </Typography>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport Radio from './Radio'\r\nimport Logo from './Logo'\r\nimport { ThemeProvider, createMuiTheme } from '@material-ui/core/styles';\r\n\r\nconst theme = createMuiTheme({\r\n  typography: {\r\n    fontFamily: [ 'Monospace' ]\r\n  },\r\n})\r\n\r\nfunction App() {\r\n  return (\r\n    <ThemeProvider theme={theme}>\r\n      <Logo />\r\n      <Radio />\r\n    </ThemeProvider>\r\n  )\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport './index.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}